{% extends 'base.html' %}
{% load static %}
{% block content %}
<link rel="stylesheet" href="{% static 'css/admin_dashboard.css' %}" />

<!-- Navbar -->
{% include 'components/navbar.html' %}

<div class="container-fluid py-4">
  <div class="row mb-4">
    <div class="col-12">
      <h4 class="text-primary mb-0">Healthcare Provider Profile</h4>
      <p class="text-muted">Manage your healthcare provider information and activity</p>
    </div>
  </div>

  <!-- Profile Information Section -->
  <div class="row g-4">
    <!-- Profile Card Section -->
    <div class="col-lg-4 col-md-5">
      <div class="card border-0 shadow-sm rounded-lg h-100">
        <div class="card-body p-4">
          <div class="text-center mb-4">
            <div class="avatar-circle bg-primary-soft mx-auto mb-3" style="width: 100px; height: 100px">
              <i class="bi bi-person-badge-fill text-primary" style="font-size: 3rem"></i>
            </div>
            <h5 class="mb-1">{{ request.user.first_name }} {{ request.user.last_name }}</h5>
            <span class="badge bg-{% if request.user.is_staff %}primary{% else %}success{% endif %} rounded-pill">
              {% if request.user.is_staff %}Municipal Health Officer{% else %}Barangay Health Worker{% endif %}
            </span>
          </div>
          <div class="border-top pt-4">
            <div class="mb-3">
              <label class="text-muted small">Healthcare Provider ID</label>
              <p class="mb-0 fw-bold">{{ request.user.username }}</p>
            </div>
            <div class="mb-3">
              <label class="text-muted small">Assigned Facility</label>
              <p class="mb-0 fw-bold">{{ facility.name|default:"Not Assigned" }}</p>
            </div>
            <div class="mb-3">
              <label class="text-muted small">Service Area</label>
              <p class="mb-0 fw-bold">Municipality of New Corella</p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Activity & Stats Section -->
    <div class="col-lg-8 col-md-7">
      <div class="card border-0 shadow-sm rounded-lg h-100">
        <div class="card-body p-4">
          <h5 class="card-title mb-4">Healthcare Activity Overview</h5>
          
          <!-- Stats Row -->
          <div class="row g-3 mb-4">
            <div class="col-sm-3">
              <div class="p-3 bg-primary-soft rounded-3">
                <h6 class="text-primary mb-1">Total Referrals</h6>
                <h3 class="mb-0">{{ total_referrals }}</h3>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="p-3 bg-warning-soft rounded-3">
                <h6 class="text-warning mb-1">In-Progress</h6>
                <h3 class="mb-0">{{ active_referrals }}</h3>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="p-3 bg-success-soft rounded-3">
                <h6 class="text-success mb-1">Completed</h6>
                <h3 class="mb-0">{{ completed_referrals }}</h3>
              </div>
            </div>
            <div class="col-sm-3">
              <div class="p-3 bg-secondary rounded-3 bg-opacity-10">
                <h6 class="text-secondary mb-1">Pending</h6>
                <h3 class="mb-0">{{ pending_referrals }}</h3>
              </div>
            </div>
          </div>

          <!-- Recent Activity Table -->
          <h6 class="mb-3">Recent Healthcare Activities</h6>
          <div class="table-responsive">
            <table class="table table-hover align-middle">
              <thead class="bg-light">
                <tr>
                  <th>Activity Type</th>
                  <th>Patient</th>
                  <th>Status</th>
                  <th>Date & Time</th>
                </tr>
              </thead>
              <tbody>
                {% if recent_activities %}
                  {% for a in recent_activities %}
                  <tr>
                    <td><i class="bi bi-{{ a.icon }} text-primary me-2"></i>{{ a.type }}</td>
                    <td>{{ a.patient }}</td>
                    <td><span class="badge bg-{{ a.badge_class }}">{{ a.status|title }}</span></td>
                    <td><small class="text-muted">{{ a.created_at|date:'M d, Y g:i A' }}</small></td>
                  </tr>
                  {% endfor %}
                {% else %}
                  <tr>
                    <td colspan="4" class="text-muted">No recent activities.</td>
                  </tr>
                {% endif %}
              </tbody>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Custom Styles -->
<style>
  .bg-primary-soft { background-color: rgba(13, 110, 253, 0.1); }
  .bg-success-soft { background-color: rgba(25, 135, 84, 0.1); }
  .bg-warning-soft { background-color: rgba(255, 193, 7, 0.1); }
  
  .avatar-circle {
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 50%;
  }
</style>

{% block script %}
<script>
document.addEventListener("DOMContentLoaded", function() {
  // Initialize any necessary interactive features
});
</script>
{% endblock %}
{% endblock %}
