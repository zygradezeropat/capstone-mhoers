{% extends 'base.html' %}
{% load static %}
{% block content %}

<link rel="stylesheet" href="{% static 'css/admin_dashboard.css' %}" />

<!-- Navbar Include -->
{% include 'components/navbar.html' %}

<div class="container-fluid py-4">
  <div class="row mb-4">
    <div class="col-12">
      <h4 class="text-primary mb-0">Analytics Dashboard</h4>
      <p class="text-muted">Monitor and analyze healthcare metrics and performance</p>
    </div>
  </div>

  <!-- Tab Navigation -->
  {% include 'components/tabbar/tabbar.html' with tab1_name="Referral Statistics" tab1_icon="bi-graph-up" tab2_name="Common Diagnoses" tab2_icon="bi-clipboard2-pulse" tab3_name="Barangay Performance" tab3_icon="bi-bar-chart" tab5_name="Generate Reports" tab5_icon="bi-printer" active_tab="tab1" %}

  <!-- Tab Content -->
  <div class="tab-content" id="dashboardTabContent">
    <!-- Tab 1: Referral Statistics -->
    <div class="tab-pane fade show active" id="tab1" role="tabpanel">
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <div class="row align-items-center mb-4">
            <div class="col-md-6">
              <select id="reportViewFilter" class="w-50" style="display: block; width: 100%; padding: 0.375rem 2.25rem 0.375rem 0.75rem; font-size: 1rem; font-weight: 400; line-height: 1.5; color: #212529; background-color: #fff; background-image: url('data:image/svg+xml,%3csvg xmlns=%27http://www.w3.org/2000/svg%27 viewBox=%270 0 16 16%27%3e%3cpath fill=%27none%27 stroke=%27%23343a40%27 stroke-linecap=%27round%27 stroke-linejoin=%27round%27 stroke-width=%272%27 d=%27m2 5 6 6 6-6%27/%3e%3c/svg%3e'); background-repeat: no-repeat; background-position: right 0.75rem center; background-size: 16px 12px; border: 1px solid #ced4da; border-radius: 0.375rem; transition: border-color .15s ease-in-out,box-shadow .15s ease-in-out; -webkit-appearance: none; -moz-appearance: none; appearance: none;">
                <option value="monthly" selected>Monthly View</option>
                <option value="yearly">Yearly View</option>
              </select>
            </div>
          </div>
          <h5 class="card-title mb-4">Monthly Referral Analytics</h5>
          <canvas id="monthlyReportChart" height="100"></canvas>
        </div>
      </div>
    </div>

    <!-- Tab 2: Common Diagnoses -->
    <div class="tab-pane fade" id="tab2" role="tabpanel">
      <div class="row g-4">
        <div class="col-md-6">
          <div class="card border-0 shadow-sm h-100">
            <div class="card-body p-4">
              <h5 class="card-title mb-4">Top Diagnosed Cases</h5>
              <div style="height: 300px;">
                <canvas id="topDiagnosedChart" style="max-height: 100%; width: 100%;"></canvas>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-6">
          <div class="card border-0 shadow-sm h-100">
            <div class="card-body p-4">
              <h5 class="card-title mb-4">Diagnosis Trends</h5>
              <div style="height: 300px;">
                <canvas id="topTrendsDiagnosed" style="max-height: 100%; width: 100%;"></canvas>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Tab 3: Barangay Performance -->
    <div class="tab-pane fade" id="tab3" role="tabpanel">
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <h5 class="card-title mb-4">Barangay Performance Analytics</h5>
          
          <div class="row mb-4">
            <div class="col-md-6 mb-4">
              <h6 class="text-muted mb-3">Referral Status Overview</h6>
              <canvas id="stackedBarangayChart" height="200"></canvas>
            </div>
            <div class="col-md-6 mb-4">
              <h6 class="text-muted mb-3">Completion Rate Analysis</h6>
              <canvas id="groupedBarangayChart" height="200"></canvas>
            </div>
          </div>
  
    
        </div>
      </div>
    </div>
    

    <!-- Tab 4: Reports -->
    <div class="tab-pane fade" id="tab5" role="tabpanel">
      <div class="card border-0 shadow-sm">
        <div class="card-body p-4">
          <h5 class="card-title mb-4">Generate Reports</h5>
          <div class="mb-4">
            <label class="form-label">Select Reports to Generate:</label>
            <div class="row g-3">
              <div class="col-md-6">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="reportTab1" name="printSelection">
                  <label class="form-check-label" for="reportTab1">Common Diagnoses Report</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="reportTab2" name="printSelection">
                  <label class="form-check-label" for="reportTab2">Barangay Performance Report</label>
                </div>
              </div>
              <div class="col-md-6">
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="reportTab3" name="printSelection">
                  <label class="form-check-label" for="reportTab3">Referral Statistics Report</label>
                </div>
                <div class="form-check">
                  <input class="form-check-input" type="checkbox" id="reportTab4" name="printSelection">
                  <label class="form-check-label" for="reportTab4">Complete Analytics Report</label>
                </div>
              </div>
            </div>
          </div>
          <div class="d-grid gap-2">
            <button id="printReportButton" class="btn btn-primary" disabled>
              <i class="bi bi-file-earmark-pdf me-2"></i>Generate Selected Reports
            </button>
          </div>
          <div class="mt-4">
            <canvas id="printReportsChart" height="150"></canvas>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>

{% block script %}
<script src="{% static 'js/user/line_chart_user.js' %}"></script>
<script src="{% static 'js/user/topDiagnosedPie_chart_user.js' %}"></script>
<script src="{% static 'js/user/barangay_performance_user.js' %}"></script>

{% endblock script %}

{% endblock %}
